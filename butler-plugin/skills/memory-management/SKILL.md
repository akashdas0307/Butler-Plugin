---
name: memory-management
description: >
  Core SOP for a two-tier memory system. Use this skill when the Master says "remember that [X]", 
  "what did I say about [Y]", "who is [Z]", or "X stands for Y". Also use implicitly whenever 
  the Master uses unrecognized shorthand, acronyms, nicknames, or project codes to decode 
  their request before taking action.
---

# Memory Management Skill

As a Chief of Staff, your greatest asset is context. You must understand the Master's internal language, relationships, and unstated preferences. This skill defines the architecture and operational protocols for acquiring, storing, and retrieving that knowledge.

## üß† Core Principles

1. **Decode Before Doing:** Never execute a command if you don't fully understand the entities involved. Decode shorthand first.
2. **Capture the Vernacular:** Always log *how* the Master refers to things (nicknames, codenames), not just the formal names.
3. **Keep the Hot Cache Fast:** Working memory (`CLAUDE.md`) must remain lean. Move stale data to Deep Memory.
4. **Never Hallucinate Context:** If a term is missing from both Hot and Deep memory, ask. Do not guess.

## üèõÔ∏è The Two-Tier Architecture

Memory is divided into local markdown files that are permanently synced to the Master's Notion database via the `/update` and `/night-routine` commands.

### Tier 1: Hot Cache (`CLAUDE.md`)
- **Purpose:** Immediate context injection. Claude reads this automatically on every prompt.
- **Contents:** Top 20 frequent contacts, top 20 acronyms, active projects, and immediate daily preferences.
- **Size Limit:** Must be kept under 100 lines to preserve tokens.

### Tier 2: Deep Memory
- **Purpose:** Comprehensive, infinite storage. Searched on demand.
- **`MEMORYLOG.md`:** The comprehensive glossary. Contains the full list of every person, project, and term ever mentioned.
- **`USER.md` & `SOUL.md`:** The Master's identity, enduring habits, communication preferences, and hard boundaries.
- **`SCRATCHPAD.md`:** Temporary hypotheses generated by the Reflection Agent, or unstructured notes.

## üîç Retrieval Protocol (Decoding Shorthand)

When the Master issues a prompt like *"Ask T about the PSR for Phoenix"*:

1. **Implicit Check (Tier 1):** Scan `CLAUDE.md`. 
   - *Example: T = Todd, PSR = Pipeline Status Report, Phoenix = DB Migration.*
2. **Explicit Search (Tier 2):** If a term is missing from `CLAUDE.md`, use your `Read` tool to scan `MEMORYLOG.md`.
3. **Clarification (Fallback):** If the term is completely unknown, halt and ask.
   - *"Master, I do not have a record of 'PSR'. What does it stand for?"*
   - Once answered, immediately proceed to the **Encoding Protocol** to save it.

## üíæ Encoding Protocol (Saving Memories)

When instructed to "remember this", or when learning a new fact, follow strict Markdown schemas. Do not write freeform paragraphs; use structured tables and lists.

### 1. Adding People
**Location:** `MEMORYLOG.md` (and `CLAUDE.md` if highly active).
**Template:**
```markdown
### [Full Name]
- **Role/Team:** [Position]
- **Nicknames/Aliases:** [e.g., T, Todd, T-Bone]
- **Preferences:** [e.g., Prefers Slack, Do not email after 5 PM]
- **Context:** [Relationship to Master]
```

### 2. Adding Terms & Acronyms
**Location:** `MEMORYLOG.md` (Glossary section).
**Template:**
`| Term | Expansion | Context |`
`|------|-----------|---------|`
`| PSR  | Pipeline Status Rpt | Weekly sales metric doc |`

### 3. Adding Projects
**Location:** `MEMORYLOG.md` (Projects section).
**Template:**
```markdown
### [Project Name / Codename]
- **Status:** [Active/Paused/Completed]
- **Key Stakeholders:** [Names]
- **Objective:** [One sentence description]
```

### 4. Updating Master's Preferences
**Location:** `USER.md` or `SOUL.md`.
- Use bullet points. 
- Group logically (e.g., `## Communication Rules`, `## Working Hours`).

## üîÑ Memory Lifecycle & Maintenance

Memories are not static. You must actively manage the health of the knowledge base.

**Promotion (Deep -> Hot)**
If a project in `MEMORYLOG.md` suddenly becomes the focus of the Master's week, copy its summary into `CLAUDE.md` so you don't have to keep retrieving it.

**Demotion (Hot -> Deep)**
If a project is completed or a person is no longer frequently mentioned, delete them from `CLAUDE.md` to save context window tokens. Ensure their permanent record remains intact in `MEMORYLOG.md`.

**Conflict Resolution**
If the Master says "Todd's title is now VP", do not create a second Todd. Find the existing entry in `MEMORYLOG.md` and overwrite the Role field.

## ‚ö†Ô∏è Quality Check & Execution

1. **Acknowledge Silently:** When updating memory, do not output the entire file to the Master. Say: *"Logged [Fact] to memory."*
2. **Deduplication:** Always verify if an acronym or person already exists before adding a new row.
3. **Hypothesis Management:** If you *suspect* a pattern but aren't sure (e.g., "Master seems to hate morning meetings"), log it to `SCRATCHPAD.md`. Let the `night-routine` reflection agent validate it later.